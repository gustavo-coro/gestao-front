import{a as W,b as X}from"./chunk-GRPTZ3TI.js";import{a as Z,b as tt,c as et,d as nt,e as it,f as ot,g as at,h as rt,i as mt,j as dt,k as ct}from"./chunk-4ZY4XCO3.js";import"./chunk-SH2TLVCK.js";import"./chunk-PBNEBNJG.js";import{a as A,b as V,c as B,d as j,e as $,f as J,g as U}from"./chunk-EMEIIDOM.js";import{d as z}from"./chunk-BB7POGC6.js";import{$a as f,Ab as g,Bb as u,C as y,Da as m,Ha as k,Kb as H,Mb as T,Oa as _,Ob as S,Pa as L,Ta as c,Tc as E,Uc as P,X as I,Ya as D,Za as d,a as w,b as O,cd as G,dd as Q,ec as F,ed as Y,fc as R,fd as K,gb as a,hb as n,ib as s,ic as N,jb as h,jc as q,kb as v,p as x,pb as p,t as C,y as b,yb as M,zb as o}from"./chunk-MQA6ALZQ.js";var lt=(()=>{class t{get vertical(){return this._vertical}set vertical(e){this._vertical=P(e)}_vertical=!1;get inset(){return this._inset}set inset(e){this._inset=P(e)}_inset=!1;static \u0275fac=function(r){return new(r||t)};static \u0275cmp=_({type:t,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(r,l){r&2&&(D("aria-orientation",l.vertical?"vertical":"horizontal"),f("mat-divider-vertical",l.vertical)("mat-divider-horizontal",!l.vertical)("mat-divider-inset",l.inset))},inputs:{vertical:"vertical",inset:"inset"},decls:0,vars:0,template:function(r,l){},styles:[`.mat-divider{display:block;margin:0;border-top-style:solid;border-top-color:var(--mat-divider-color, var(--mat-sys-outline));border-top-width:var(--mat-divider-width, 1px)}.mat-divider.mat-divider-vertical{border-top:0;border-right-style:solid;border-right-color:var(--mat-divider-color, var(--mat-sys-outline));border-right-width:var(--mat-divider-width, 1px)}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}
`],encapsulation:2,changeDetection:0})}return t})(),st=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=L({type:t});static \u0275inj=I({imports:[E,E]})}return t})();function ft(t,i){t&1&&s(0,"mat-progress-bar",23)}function ht(t,i){if(t&1&&(a(0,"li",37)(1,"mat-icon",38),o(2,"fiber_manual_record"),n(),o(3),n()),t&2){let e=i.$implicit;m(3),u(" ",e.nome||e.name||(e.idVenda?"Venda "+e.idVenda:"Item sem nome")," ")}}function vt(t,i){if(t&1&&(h(0),a(1,"ul",35),c(2,ht,4,1,"li",36),n(),v()),t&2){let e=p().$implicit;m(2),d("ngForOf",e.recentItems)}}function xt(t,i){t&1&&(a(0,"p",39),o(1,"Nenhum cadastro recente"),n())}function Ct(t,i){if(t&1&&(a(0,"mat-card",26)(1,"mat-card-header",27)(2,"div",28)(3,"mat-icon"),o(4),n()(),a(5,"mat-card-title"),o(6),n()(),a(7,"mat-card-content")(8,"div",29)(9,"p",30),o(10),n(),a(11,"p",31),o(12,"Registrados"),n()(),s(13,"mat-divider"),a(14,"div",32)(15,"h4",33),o(16,"\xDAltimos cadastros:"),n(),c(17,vt,3,1,"ng-container",34)(18,xt,2,0,"ng-template",null,0,S),n()()()),t&2){let e=i.$implicit,r=M(19);m(),d("routerLink",e.link),m(3),g(e.icon),m(2),g(e.title),m(2),d("routerLink",e.link),m(2),g(e.count),m(7),d("ngIf",e.recentItems.length>0)("ngIfElse",r)}}function bt(t,i){if(t&1&&(a(0,"div",24),c(1,Ct,20,7,"mat-card",25),n()),t&2){let e=p();m(),d("ngForOf",e.dashboardCards)}}function yt(t,i){if(t&1&&(a(0,"div",42)(1,"h4"),o(2),n(),a(3,"p")(4,"strong"),o(5,"Vendas:"),n(),o(6),n(),a(7,"p")(8,"strong"),o(9,"Total:"),n(),o(10),H(11,"currency"),n()()),t&2){let e=i.$implicit;m(2),g(e.monthName),m(4),u(" ",e.numero_vendas,""),m(4),u(" ",T(11,3,e.valor_total_vendas,"BRL"),"")}}function Mt(t,i){if(t&1&&(a(0,"mat-card",2)(1,"mat-card-title"),o(2,"Vendas por M\xEAs (Ano Corrente)"),n(),a(3,"mat-card-content")(4,"div",40),c(5,yt,12,6,"div",41),n()()()),t&2){let e=p();m(5),d("ngForOf",e.monthlyStats)}}function St(t,i){t&1&&(a(0,"th",53),o(1," Produto "),n())}function Et(t,i){if(t&1&&(a(0,"td",54),o(1),n()),t&2){let e=i.$implicit;m(),u(" ",e.nome_produto," ")}}function Pt(t,i){t&1&&(a(0,"th",53),o(1," Quantidade em Estoque "),n())}function wt(t,i){if(t&1&&(a(0,"td",54),o(1),n()),t&2){let e=i.$implicit;f("low-stock",e.qtd_produto<10&&e.qtd_produto>0)("very-low-stock",e.qtd_produto===0),m(),u(" ",e.qtd_produto," ")}}function Ot(t,i){t&1&&s(0,"tr",55)}function It(t,i){t&1&&s(0,"tr",56)}function kt(t,i){if(t&1&&(a(0,"div",44)(1,"table",45),h(2,46),c(3,St,2,0,"th",47)(4,Et,2,1,"td",48),v(),h(5,49),c(6,Pt,2,0,"th",47)(7,wt,2,5,"td",50),v(),c(8,Ot,1,0,"tr",51)(9,It,1,0,"tr",52),n()()),t&2){let e=p(2);m(),d("dataSource",e.lowStockProducts),m(7),d("matHeaderRowDef",e.displayedColumns),m(),d("matRowDefColumns",e.displayedColumns)}}function Lt(t,i){t&1&&(a(0,"p"),o(1,"Nenhum produto com baixo estoque encontrado."),n())}function Dt(t,i){if(t&1&&(a(0,"mat-card-content"),c(1,kt,10,3,"div",43)(2,Lt,2,0,"ng-template",null,1,S),n()),t&2){let e=M(3),r=p();m(),d("ngIf",r.lowStockProducts.length>0)("ngIfElse",e)}}function Ht(t,i){t&1&&(a(0,"div",57),s(1,"mat-progress-bar",58),a(2,"p"),o(3,"Carregando produtos..."),n()())}function Tt(t,i){t&1&&(a(0,"div",59),s(1,"mat-progress-bar",58),a(2,"p"),o(3,"Carregando dados..."),n()())}var pt=class t{constructor(i){this.api=i}dashboardCards=[];monthlyStats=[];lowStockProducts=[];displayedColumns=["nome_produto","qtd_produto"];isLoading=!0;isLoadingStats=!0;isLoadingProducts=!0;ngOnInit(){this.loadDashboardData(),this.loadMonthlySalesStats(),this.loadLowStockProducts()}loadDashboardData(){this.isLoading=!0,b({customers:this.api.getCustomers(),companies:this.api.getCompanies(),employees:this.api.getEmployees(),suppliers:this.api.getSuppliers(),products:this.api.getProducts(),sales:this.api.getSales()}).subscribe({next:i=>{let e=r=>r.slice(-3).reverse();this.dashboardCards=[{title:"Clientes",count:i.customers.length,icon:"people",link:"/clientes",recentItems:e(i.customers)},{title:"Empresas",count:i.companies.length,icon:"business",link:"/empresa",recentItems:e(i.companies)},{title:"Funcion\xE1rios",count:i.employees.length,icon:"badge",link:"/funcionario",recentItems:e(i.employees)},{title:"Fornecedores",count:i.suppliers.length,icon:"local_shipping",link:"/fornecedor",recentItems:e(i.suppliers)},{title:"Produtos",count:i.products.length,icon:"inventory_2",link:"/products",recentItems:e(i.products)},{title:"Vendas",count:i.sales.length,icon:"point_of_sale",link:"/vendas",recentItems:e(i.sales)}],this.isLoading=!1},error:i=>{console.error("Erro ao carregar dados da dashboard",i),this.isLoading=!1}})}loadMonthlySalesStats(){this.isLoadingStats=!0;let i=["Janeiro","Fevereiro","Mar\xE7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],e=Array.from({length:12},(r,l)=>this.api.getSalesStatsForMonth(l+1).pipe(C(ut=>O(w({},ut),{monthName:i[l],monthNumber:l+1})),y(()=>x({numero_vendas:0,valor_total_vendas:0,monthName:i[l],monthNumber:l+1}))));b(e).subscribe({next:r=>{this.monthlyStats=r,this.isLoadingStats=!1},error:r=>{console.error("Erro ao carregar estat\xEDsticas mensais",r),this.isLoadingStats=!1}})}loadLowStockProducts(){this.isLoadingProducts=!0,this.api.getProducts().pipe(C(i=>i.sort((e,r)=>e.qtd_produto-r.qtd_produto).slice(0,100)),y(i=>(console.error("Erro ao buscar produtos",i),x([])))).subscribe(i=>{this.lowStockProducts=i,this.isLoadingProducts=!1})}static \u0275fac=function(e){return new(e||t)(k(U))};static \u0275cmp=_({type:t,selectors:[["app-home"]],decls:62,vars:6,consts:[["noRecentItems",""],["noProducts",""],[1,"home-card"],[1,"card-header"],["mode","indeterminate","color","accent",4,"ngIf"],[1,"actions"],["mat-raised-button","","color","warn","routerLink","/fornecedor-produtos",1,"action-button"],["mat-raised-button","","color","primary","routerLink","/products",1,"action-button"],["mat-raised-button","","color","primary","routerLink","/clientes",1,"action-button"],["mat-raised-button","","color","accent","routerLink","/clientes/new",1,"action-button"],["mat-raised-button","","color","primary","routerLink","/empresa",1,"action-button"],["mat-raised-button","","color","accent","routerLink","/empresa/new",1,"action-button"],["mat-raised-button","","color","primary","routerLink","/funcionario",1,"action-button"],["mat-raised-button","","color","accent","routerLink","/funcionario/new",1,"action-button"],["mat-raised-button","","color","primary","routerLink","/vendas",1,"action-button"],["mat-raised-button","","color","accent","routerLink","/vendas/new",1,"action-button"],["mat-raised-button","","color","primary","routerLink","/fornecedor",1,"action-button"],["mat-raised-button","","color","accent","routerLink","/fornecedor/new",1,"action-button"],["class","dashboard-container",4,"ngIf"],["class","home-card",4,"ngIf"],[4,"ngIf"],["class","loading-container",4,"ngIf"],["class","loading-overlay",4,"ngIf"],["mode","indeterminate","color","accent"],[1,"dashboard-container"],["class","dashboard-card",4,"ngFor","ngForOf"],[1,"dashboard-card"],[1,"dashboard-header",3,"routerLink"],["mat-card-avatar","",1,"dashboard-icon"],[1,"count-section",3,"routerLink"],[1,"count"],[1,"count-label"],[1,"recent-items-container"],[1,"recent-items-title"],[4,"ngIf","ngIfElse"],[1,"recent-items-list"],["class","recent-item",4,"ngFor","ngForOf"],[1,"recent-item"],[1,"item-icon"],[1,"no-items-message"],[1,"stats-container"],["class","stat-item",4,"ngFor","ngForOf"],[1,"stat-item"],["class","table-container",4,"ngIf","ngIfElse"],[1,"table-container"],["mat-table","",1,"low-stock-table",3,"dataSource"],["matColumnDef","nome_produto"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","qtd_produto"],["mat-cell","",3,"low-stock","very-low-stock",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],[1,"loading-container"],["mode","indeterminate"],[1,"loading-overlay"]],template:function(e,r){e&1&&(a(0,"mat-card",2)(1,"div",3)(2,"h1"),o(3,"Menu Principal"),n(),c(4,ft,1,0,"mat-progress-bar",4),n(),a(5,"div",5)(6,"button",6)(7,"mat-icon"),o(8,"search"),n(),o(9," Consultar Produtos Fornecedor "),n(),a(10,"button",7)(11,"mat-icon"),o(12,"inventory_2"),n(),o(13," Gerenciar Produtos "),n(),a(14,"button",8)(15,"mat-icon"),o(16,"people"),n(),o(17," Listar Clientes "),n(),a(18,"button",9)(19,"mat-icon"),o(20,"person_add"),n(),o(21," Cadastrar Cliente "),n(),a(22,"button",10)(23,"mat-icon"),o(24,"business"),n(),o(25," Listar Empresas "),n(),a(26,"button",11)(27,"mat-icon"),o(28,"add_business"),n(),o(29," Cadastrar Empresa "),n(),a(30,"button",12)(31,"mat-icon"),o(32,"badge"),n(),o(33," Listar Funcion\xE1rios "),n(),a(34,"button",13)(35,"mat-icon"),o(36,"person_add_alt"),n(),o(37," Cadastrar Funcion\xE1rio "),n(),a(38,"button",14)(39,"mat-icon"),o(40,"receipt"),n(),o(41," Listar Vendas "),n(),a(42,"button",15)(43,"mat-icon"),o(44,"add_shopping_cart"),n(),o(45," Cadastrar Venda "),n(),a(46,"button",16)(47,"mat-icon"),o(48,"local_shipping"),n(),o(49," Listar Fornecedores "),n(),a(50,"button",17)(51,"mat-icon"),o(52,"add_business"),n(),o(53," Cadastrar Fornecedor "),n()()(),c(54,bt,2,1,"div",18)(55,Mt,6,1,"mat-card",19),a(56,"mat-card",2)(57,"mat-card-title"),o(58,"Produtos com Menor Estoque"),n(),c(59,Dt,4,2,"mat-card-content",20)(60,Ht,4,0,"div",21),n(),c(61,Tt,4,0,"div",22)),e&2&&(m(4),d("ngIf",r.isLoading),m(50),d("ngIf",!r.isLoading),m(),d("ngIf",!r.isLoadingStats),m(4),d("ngIf",!r.isLoadingProducts),m(),d("ngIf",r.isLoadingProducts),m(),d("ngIf",r.isLoading||r.isLoadingStats||r.isLoadingProducts))},dependencies:[q,F,R,N,z,J,A,$,B,j,V,Q,G,K,Y,st,lt,X,W,ct,Z,et,at,nt,tt,rt,it,ot,mt,dt],styles:[".home-card[_ngcontent-%COMP%]{max-width:1200px;margin:2rem auto;padding:2rem;border-radius:16px;box-shadow:0 4px 20px #00000014}.card-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.card-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:var(--primary-color);font-size:2rem;margin-bottom:.5rem;text-align:center}.actions[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1rem;margin-top:1.5rem}.action-button[_ngcontent-%COMP%]{height:56px;display:flex;align-items:center;justify-content:center;font-weight:500}.action-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.dashboard-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1.5rem;margin:2rem auto;max-width:1200px;padding:0 1rem}.dashboard-card[_ngcontent-%COMP%]{border-radius:12px;overflow:hidden;transition:transform .2s ease,box-shadow .2s ease}.dashboard-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 6px 24px #0000001f}.dashboard-header[_ngcontent-%COMP%]{background:#4361ee0d;padding:1rem;cursor:pointer}.dashboard-header[_ngcontent-%COMP%]:hover{background:#4361ee14}.dashboard-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:var(--primary-color);color:#fff;border-radius:50%;width:40px;height:40px}.dashboard-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px}.count-section[_ngcontent-%COMP%]{text-align:center;padding:1.5rem 1rem;cursor:pointer}.count[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:600;color:var(--primary-color);margin:0;line-height:1}.count-label[_ngcontent-%COMP%]{color:var(--text-secondary);margin:.5rem 0 0;font-size:.9rem}mat-divider[_ngcontent-%COMP%]{margin:.5rem 0}.recent-items-container[_ngcontent-%COMP%]{padding:1rem;flex-grow:1}.recent-items-title[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:.9rem;font-weight:500;color:var(--text-secondary)}.recent-items-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.recent-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5rem 0;font-size:.9rem;border-bottom:1px solid rgba(0,0,0,.08);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.recent-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.item-icon[_ngcontent-%COMP%]{font-size:8px;width:16px;height:16px;margin-right:8px;color:var(--primary-color)}.no-items-message[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.9rem;text-align:center;padding:1rem 0;margin:0}.loading-overlay[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem;text-align:center}.loading-text[_ngcontent-%COMP%]{margin-top:1rem;color:var(--text-secondary)}.stats-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:1.5rem;margin-top:1.5rem;text-align:left}.stat-item[_ngcontent-%COMP%]{border:1px solid #eee;padding:1rem;border-radius:8px;background-color:#f9f9f9}.stat-item[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .5rem;font-weight:500;color:#333}.stat-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.9rem;color:#555}.table-container[_ngcontent-%COMP%]{max-height:400px;overflow:auto;margin-top:1rem}.low-stock-table[_ngcontent-%COMP%]{width:100%}.loading-container[_ngcontent-%COMP%]{padding:2rem;text-align:center}.mat-mdc-cell[_ngcontent-%COMP%]{padding:8px}.mat-mdc-header-cell[_ngcontent-%COMP%]{font-weight:700}.low-stock[_ngcontent-%COMP%]{color:orange;font-weight:700}.very-low-stock[_ngcontent-%COMP%]{color:red;font-weight:700}@media (max-width: 768px){.actions[_ngcontent-%COMP%], .dashboard-container[_ngcontent-%COMP%]{grid-template-columns:1fr}.home-card[_ngcontent-%COMP%]{margin:1rem;padding:1.5rem}}"]})};export{pt as HomeComponent};
