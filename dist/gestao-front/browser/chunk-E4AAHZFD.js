import{A as J,B as L,F as H,G as K,b as O,d as s,f as N,g as $,j as q,l as T,m as R,o as w,q as D,s as A,t as z,u as B,x as k}from"./chunk-KWAF5XDU.js";import{a as V,f as G,g as Z}from"./chunk-EMEIIDOM.js";import{a as P,c as j}from"./chunk-BB7POGC6.js";import{Ab as C,Bb as F,Da as l,Ha as d,Oa as S,Ta as u,Za as p,a as _,cd as Q,dd as U,ed as W,fc as I,fd as Y,gb as o,hb as r,ib as c,jc as X,ob as g,zb as i}from"./chunk-MQA6ALZQ.js";function te(m,n){m&1&&(o(0,"mat-error"),i(1," Nome \xE9 obrigat\xF3rio "),r())}function re(m,n){m&1&&(o(0,"mat-error"),i(1," CNPJ \xE9 obrigat\xF3rio "),r())}function ne(m,n){m&1&&(o(0,"mat-error"),i(1," CNPJ inv\xE1lido "),r())}function oe(m,n){m&1&&(o(0,"mat-error"),i(1," Raz\xE3o Social \xE9 obrigat\xF3ria "),r())}function ie(m,n){m&1&&(o(0,"mat-error"),i(1," E-mail \xE9 obrigat\xF3rio "),r())}function me(m,n){m&1&&(o(0,"mat-error"),i(1," E-mail inv\xE1lido "),r())}function ae(m,n){m&1&&(o(0,"mat-error"),i(1," Telefone \xE9 obrigat\xF3rio "),r())}function le(m,n){m&1&&(o(0,"mat-error"),i(1," Formato: (XX) XXXXX-XXXX "),r())}function pe(m,n){m&1&&(o(0,"mat-error"),i(1," Endere\xE7o \xE9 obrigat\xF3rio "),r())}var ee=class m{constructor(n,e,t,a){this.fb=n;this.api=e;this.router=t;this.route=a}form;isEdit=!1;companyIdFromRoute;ngOnInit(){this.form=this.fb.group({nome_empresa:["",s.required],cnpj_empresa:["",s.required],endereco:["",s.required],razao_social:["",s.required],email:["",[s.required,s.email]],telefone:["",[s.required,s.pattern(/^\(\d{2}\) \d{4,5}-\d{4}$/)]]});let n=this.route.snapshot.paramMap.get("cnpj_empresa");n&&(this.isEdit=!0,this.companyIdFromRoute=n,this.api.getCompany(this.companyIdFromRoute).subscribe(e=>{console.log("Empresa recebida:",e);let t=_({},e);t.cnpj_empresa&&(t.cnpj_empresa=this.applyCnpjMask(String(t.cnpj_empresa))),this.form.patchValue(t)}))}applyCnpjMask(n){let e=n.replace(/\D/g,"").substring(0,14);return e.length===0?"":e.length<=2?e:e.length<=5?`${e.substring(0,2)}.${e.substring(2)}`:e.length<=8?`${e.substring(0,2)}.${e.substring(2,5)}.${e.substring(5)}`:e.length<=12?`${e.substring(0,2)}.${e.substring(2,5)}.${e.substring(5,8)}/${e.substring(8)}`:`${e.substring(0,2)}.${e.substring(2,5)}.${e.substring(5,8)}/${e.substring(8,12)}-${e.substring(12,14)}`}formatCnpjOnInput(n){let t=n.target.value,a=this.applyCnpjMask(t);this.form.get("cnpj_empresa")?.setValue(a,{emitEvent:!1})}formatPhone(n){let e=n.target.value.replace(/\D/g,""),t="";if(e.length>0&&(t=`(${e.substring(0,2)}`),e.length>2){let a=e.substring(2);a.length>0&&(t+=") ",a.length<=4?t+=a:a.length<=8?(t+=`${a.substring(0,a.length<=5&&e.length===11?5:4)}`,a.length>4&&(t+=`-${a.substring(a.length<=5&&e.length===11?5:4,9)}`)):t+=`${a.substring(0,5)}-${a.substring(5,9)}`)}this.form.get("telefone")?.setValue(t.substring(0,15),{emitEvent:!1})}onSubmit(){if(this.form.invalid){this.form.markAllAsTouched(),console.warn("Formul\xE1rio inv\xE1lido:",this.form.errors);return}let n=_({},this.form.value);n.cnpj_empresa&&(n.cnpj_empresa=String(n.cnpj_empresa).replace(/\D/g,"")),console.log("onSubmit company (dados limpos):",n),(this.isEdit?this.api.updateCompany(this.companyIdFromRoute,n):this.api.createCompany(n)).subscribe({next:t=>{console.log("Empresa salva com sucesso",t),this.router.navigate(["/empresa"])},error:t=>console.error("Erro ao salvar empresa:",t)})}static \u0275fac=function(e){return new(e||m)(d(D),d(Z),d(j),d(P))};static \u0275cmp=S({type:m,selectors:[["app-company-form"]],decls:56,vars:13,consts:[[1,"form-card"],[1,"form-header"],[1,"form-content",3,"ngSubmit","formGroup"],["appearance","outline",1,"form-field"],["matInput","","formControlName","nome_empresa","required",""],["matSuffix",""],[4,"ngIf"],["matInput","","formControlName","cnpj_empresa","placeholder","XX.XXX.XXX/XXXX-XX","required","",3,"input"],["matInput","","formControlName","razao_social","required",""],[1,"form-row"],["matInput","","formControlName","email","type","email","required",""],["matInput","","formControlName","telefone","placeholder","(XX) XXXX-XXXX","required","",3,"input"],["matInput","","formControlName","endereco","type","text","required",""],[1,"form-actions"],["mat-raised-button","","color","primary","type","submit",1,"submit-button"]],template:function(e,t){if(e&1&&(o(0,"mat-card",0)(1,"div",1)(2,"h2"),i(3),r()(),o(4,"form",2),g("ngSubmit",function(){return t.onSubmit()}),o(5,"mat-form-field",3)(6,"mat-label"),i(7,"Nome"),r(),c(8,"input",4),o(9,"mat-icon",5),i(10,"business"),r(),u(11,te,2,0,"mat-error",6),r(),o(12,"mat-form-field",3)(13,"mat-label"),i(14,"CNPJ"),r(),o(15,"input",7),g("input",function(f){return t.formatCnpjOnInput(f)}),r(),o(16,"mat-icon",5),i(17,"fingerprint"),r(),u(18,re,2,0,"mat-error",6)(19,ne,2,0,"mat-error",6),r(),o(20,"mat-form-field",3)(21,"mat-label"),i(22,"Raz\xE3o Social"),r(),c(23,"input",8),o(24,"mat-icon",5),i(25,"description"),r(),u(26,oe,2,0,"mat-error",6),r(),o(27,"div",9)(28,"mat-form-field",3)(29,"mat-label"),i(30,"E-mail"),r(),c(31,"input",10),o(32,"mat-icon",5),i(33,"email"),r(),u(34,ie,2,0,"mat-error",6)(35,me,2,0,"mat-error",6),r(),o(36,"mat-form-field",3)(37,"mat-label"),i(38,"Telefone"),r(),o(39,"input",11),g("input",function(f){return t.formatPhone(f)}),r(),o(40,"mat-icon",5),i(41,"phone"),r(),u(42,ae,2,0,"mat-error",6)(43,le,2,0,"mat-error",6),r()(),o(44,"mat-form-field",3)(45,"mat-label"),i(46,"Endere\xE7o"),r(),c(47,"input",12),o(48,"mat-icon",5),i(49,"location_on"),r(),u(50,pe,2,0,"mat-error",6),r(),o(51,"div",13)(52,"button",14)(53,"mat-icon"),i(54),r(),i(55),r()()()()),e&2){let a,f,E,b,h,y,v,M,x;l(3),C(t.isEdit?"Editar Empresa":"Nova Empresa"),l(),p("formGroup",t.form),l(7),p("ngIf",(a=t.form.get("nome_empresa"))==null?null:a.hasError("required")),l(7),p("ngIf",(f=t.form.get("cnpj_empresa"))==null?null:f.hasError("required")),l(),p("ngIf",(E=t.form.get("cnpj_empresa"))==null?null:E.hasError("pattern")),l(7),p("ngIf",(b=t.form.get("razao_social"))==null?null:b.hasError("required")),l(8),p("ngIf",(h=t.form.get("email"))==null?null:h.hasError("required")),l(),p("ngIf",(y=t.form.get("email"))==null?null:y.hasError("email")),l(7),p("ngIf",(v=t.form.get("telefone"))==null?null:v.hasError("required")),l(),p("ngIf",(M=t.form.get("telefone"))==null?null:M.hasError("pattern")),l(7),p("ngIf",(x=t.form.get("endereco"))==null?null:x.hasError("required")),l(4),C(t.isEdit?"save":"add"),l(),F(" ",t.isEdit?"Salvar":"Criar"," ")}},dependencies:[X,I,A,q,O,N,$,w,T,R,G,V,L,J,z,B,k,K,H,U,Q,Y,W],styles:[".form-card[_ngcontent-%COMP%]{max-width:800px;margin:2rem auto;padding:2rem;border-radius:16px;overflow:hidden}.form-header[_ngcontent-%COMP%]{margin-bottom:2rem}.form-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:.5rem}.form-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.form-row[_ngcontent-%COMP%]{display:flex;gap:1.5rem}.form-row[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{flex:1}.form-field[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--text-secondary)}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;margin-top:1.5rem}.submit-button[_ngcontent-%COMP%]{min-width:120px}.cancel-button[_ngcontent-%COMP%]{border-color:var(--text-secondary);color:var(--text-secondary)}.loading-overlay[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:300px}@media (max-width: 768px){.form-card[_ngcontent-%COMP%]{padding:1.5rem;margin:1rem}.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.form-actions[_ngcontent-%COMP%]{flex-direction:column-reverse}.submit-button[_ngcontent-%COMP%], .cancel-button[_ngcontent-%COMP%]{width:100%}}"]})};export{ee as CompanyFormComponent};
