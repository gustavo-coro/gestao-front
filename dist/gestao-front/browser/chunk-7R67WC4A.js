import{a as de}from"./chunk-GFX6PFIB.js";import{a as fe}from"./chunk-JBCGYZPP.js";import{a as le,b as me}from"./chunk-QU57BB5G.js";import{a as X,b as Y,c as Z,d as ee,e as te,f as re,g as ie,h as ne,i as oe,j as ae,k as pe}from"./chunk-4ZY4XCO3.js";import"./chunk-SH2TLVCK.js";import"./chunk-FO32T2ZT.js";import"./chunk-PBNEBNJG.js";import{A as J,B as A,F as G,G as z,b as y,d as I,f as O,g as w,j as D,l as $,m as N,o as T,q as j,s as B,t as k,u as q,x as H}from"./chunk-KWAF5XDU.js";import{a as R,f as V,g as W}from"./chunk-EMEIIDOM.js";import{Ab as v,Bb as d,Da as a,Ha as u,Kb as M,Nb as S,Oa as P,Ta as m,Za as l,cd as L,dd as K,e as ue,ed as Q,fc as b,fd as U,gb as o,hb as r,ib as C,ic as E,jb as f,jc as F,kb as _,ob as h,pb as g,zb as n}from"./chunk-MQA6ALZQ.js";var se=ue(fe());function _e(t,i){t&1&&(o(0,"mat-error"),n(1," CPF/CNPJ \xE9 obrigat\xF3rio "),r())}function Ce(t,i){t&1&&(o(0,"mat-error"),n(1," CPF inv\xE1lido "),r())}function he(t,i){t&1&&(o(0,"mat-error"),n(1," CNPJ inv\xE1lido "),r())}function ge(t,i){t&1&&(o(0,"th",24),n(1,"Nome"),r())}function ve(t,i){if(t&1&&(o(0,"td",25),n(1),r()),t&2){let e=i.$implicit;a(),v(e.nome_produto)}}function xe(t,i){t&1&&(o(0,"th",24),n(1,"Pre\xE7o de Venda"),r())}function Pe(t,i){if(t&1&&(o(0,"td",26),n(1),M(2,"currency"),r()),t&2){let e=i.$implicit;a(),d(" ",S(2,1,e.valor_venda,"BRL","symbol","1.2-2")," ")}}function Me(t,i){t&1&&(o(0,"th",24),n(1,"Estoque"),r())}function Se(t,i){if(t&1&&(o(0,"td",25),n(1),r()),t&2){let e=i.$implicit;a(),v(e.qtd_produto)}}function be(t,i){t&1&&C(0,"tr",27)}function Ee(t,i){t&1&&C(0,"tr",28)}function Fe(t,i){if(t&1&&(o(0,"div",14)(1,"table",15),f(2,16),m(3,ge,2,0,"th",17)(4,ve,2,1,"td",18),_(),f(5,19),m(6,xe,2,0,"th",17)(7,Pe,3,6,"td",20),_(),f(8,21),m(9,Me,2,0,"th",17)(10,Se,2,1,"td",18),_(),m(11,be,1,0,"tr",22)(12,Ee,1,0,"tr",23),r()()),t&2){let e=g(2);a(),l("dataSource",e.products),a(10),l("matHeaderRowDef",e.displayedColumns),a(),l("matRowDefColumns",e.displayedColumns)}}function ye(t,i){t&1&&(o(0,"div",29)(1,"mat-icon"),n(2,"inventory"),r(),o(3,"p"),n(4,"Nenhum produto encontrado para este fornecedor"),r()())}function Ie(t,i){if(t&1&&(o(0,"div",9)(1,"div",10)(2,"h3")(3,"mat-icon"),n(4,"local_shipping"),r(),n(5),r(),o(6,"p",11)(7,"span")(8,"mat-icon"),n(9,"email"),r(),n(10),r(),o(11,"span")(12,"mat-icon"),n(13,"phone"),r(),n(14),r()()(),m(15,Fe,13,3,"div",12)(16,ye,5,0,"div",13),r()),t&2){let e=g();a(5),d(" Fornecedor: ",e.supplier.nome_fornecedor," "),a(5),d(" ",e.supplier.email_fornecedor,""),a(4),d(" ",e.supplier.telefone_fornecedor,""),a(),l("ngIf",e.products.length>0),a(),l("ngIf",e.products.length===0&&e.supplier)}}var ce=class t{constructor(i,e,p){this.fb=i;this.api=e;this.snackBar=p;this.searchForm=this.fb.group({cpf_cnpj:["",[I.required,this.validateCpfCnpj]]})}searchForm;supplier=null;products=[];displayedColumns=["nome_produto","valor_venda","qtd_produto"];validateCpfCnpj(i){let e=i.value?i.value.replace(/\D/g,""):"";return e.length===11&&!(0,se.isValid)(e)?{invalidCpf:!0}:e.length===14&&!de(e)?{invalidCnpj:!0}:null}formatCpfCnpj(i){let e=i.target.value.replace(/\D/g,"");e.length<=11?(e.length>3&&(e=e.replace(/^(\d{3})(\d)/,"$1.$2")),e.length>6&&(e=e.replace(/^(\d{3})\.(\d{3})(\d)/,"$1.$2.$3")),e.length>9&&(e=e.replace(/^(\d{3})\.(\d{3})\.(\d{3})(\d)/,"$1.$2.$3-$4"))):(e=e.replace(/^(\d{2})(\d)/,"$1.$2"),e=e.replace(/^(\d{2})\.(\d{3})(\d)/,"$1.$2.$3"),e=e.replace(/\.(\d{3})(\d)/,".$1/$2"),e=e.replace(/(\d{4})(\d)/,"$1-$2")),this.searchForm.get("cpf_cnpj")?.setValue(e.substring(0,18),{emitEvent:!1})}search(){if(this.searchForm.invalid){this.snackBar.open("Por favor, insira um CPF/CNPJ v\xE1lido.","Fechar",{duration:3e3});return}let i=this.searchForm.value.cpf_cnpj;if(!i){this.snackBar.open("CPF/CNPJ n\xE3o pode estar vazio.","Fechar",{duration:3e3});return}let e=i.replace(/\D/g,"");this.api.getSupplierProducts(e).subscribe({next:p=>{this.supplier=p.supplier,this.products=p.products,this.products.length===0&&this.snackBar.open("Nenhum produto encontrado para este fornecedor.","Fechar",{duration:3e3})},error:p=>{console.error("Erro na busca:",p),this.supplier=null,this.products=[],this.snackBar.open("Erro ao buscar produtos do fornecedor. Verifique o CPF/CNPJ.","Fechar",{duration:3e3})}})}static \u0275fac=function(e){return new(e||t)(u(j),u(W),u(le))};static \u0275cmp=P({type:t,selectors:[["app-supplier-products"]],decls:19,vars:6,consts:[[1,"search-card"],[1,"search-header"],[1,"search-form",3,"ngSubmit","formGroup"],["appearance","outline",1,"search-field"],["matInput","","formControlName","cpf_cnpj","placeholder","000.000.000-00 ou 00.000.000/0000-00","required","",3,"input"],["matSuffix",""],[4,"ngIf"],["mat-raised-button","","color","primary","type","submit",1,"search-button",3,"disabled"],["class","results-section",4,"ngIf"],[1,"results-section"],[1,"supplier-info"],[1,"supplier-details"],["class","table-container",4,"ngIf"],["class","no-results",4,"ngIf"],[1,"table-container"],["mat-table","",1,"results-table","mat-elevation-z4",3,"dataSource"],["matColumnDef","nome_produto"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","valor_venda"],["mat-cell","","class","text-right",4,"matCellDef"],["matColumnDef","qtd_produto"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-cell","",1,"text-right"],["mat-header-row",""],["mat-row",""],[1,"no-results"]],template:function(e,p){if(e&1&&(o(0,"mat-card",0)(1,"div",1)(2,"h2"),n(3,"Consultar Produtos por Fornecedor"),r()(),o(4,"form",2),h("ngSubmit",function(){return p.search()}),o(5,"mat-form-field",3)(6,"mat-label"),n(7,"CPF/CNPJ do Fornecedor"),r(),o(8,"input",4),h("input",function(s){return p.formatCpfCnpj(s)}),r(),o(9,"mat-icon",5),n(10,"search"),r(),m(11,_e,2,0,"mat-error",6)(12,Ce,2,0,"mat-error",6)(13,he,2,0,"mat-error",6),r(),o(14,"button",7)(15,"mat-icon"),n(16,"search"),r(),n(17," Buscar "),r()(),m(18,Ie,17,5,"div",8),r()),e&2){let c,s,x;a(4),l("formGroup",p.searchForm),a(7),l("ngIf",(c=p.searchForm.get("cpf_cnpj"))==null?null:c.hasError("required")),a(),l("ngIf",(s=p.searchForm.get("cpf_cnpj"))==null?null:s.hasError("invalidCpf")),a(),l("ngIf",(x=p.searchForm.get("cpf_cnpj"))==null?null:x.hasError("invalidCnpj")),a(),l("disabled",p.searchForm.invalid),a(4),l("ngIf",p.supplier)}},dependencies:[F,b,E,B,D,y,O,w,T,$,N,V,R,A,J,k,q,H,z,G,K,L,pe,X,Z,ie,ee,Y,ne,te,re,oe,ae,me,U,Q],styles:[".search-card[_ngcontent-%COMP%]{max-width:800px;margin:2rem auto;padding:2rem;border-radius:16px;box-shadow:0 4px 20px #00000014}.search-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.search-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--primary-color);margin-bottom:.5rem}.search-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.search-field[_ngcontent-%COMP%]{width:100%}.search-button[_ngcontent-%COMP%]{height:56px;font-weight:500}.results-section[_ngcontent-%COMP%]{margin-top:2rem}.supplier-info[_ngcontent-%COMP%]{margin-bottom:1.5rem}.supplier-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:var(--primary-color)}.supplier-details[_ngcontent-%COMP%]{display:flex;gap:1.5rem;margin-top:.5rem;color:var(--text-secondary)}.supplier-details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.supplier-details[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.table-container[_ngcontent-%COMP%]{border-radius:12px;overflow:hidden;margin:1.5rem 0;box-shadow:0 2px 16px #00000014}.results-table[_ngcontent-%COMP%]{width:100%}.text-right[_ngcontent-%COMP%]{text-align:right}.no-results[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:var(--text-secondary);font-size:1.1rem}.no-results[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:1rem;opacity:.6}.no-results[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}@media (max-width: 768px){.search-card[_ngcontent-%COMP%]{padding:1.5rem;margin:1rem}.supplier-details[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}}"]})};export{ce as SupplierProductsComponent};
